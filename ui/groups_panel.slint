import { ScrollView, VerticalBox, HorizontalBox } from "std-widgets.slint";
import { PersonData, GroupData } from "types.slint";

component GroupItem inherits Rectangle {
    in property <GroupData> group_data;
    private property <bool> expanded: false;
    background: expanded ? #2E2E2E : #252525;
    border-radius: 8px;
    width: 100%;

    VerticalBox {
        spacing: 8px;
        
        Rectangle {
            height: 32px;
            background: transparent;

            HorizontalBox {
                Rectangle {
                    Text {
                        text: group_data.name;
                        font-size: 18px; color: #FFD700;
                        vertical-alignment: center;
                    }
                }
                
                Rectangle { horizontal-stretch: 1.0; }
                
                Rectangle {
                    Text { text: expanded ? "▲" : "▼"; color: #999999; font-size: 16px; }
                }
            } 
            
            TouchArea { clicked => { expanded = !expanded; } }
        }
        
        if expanded: VerticalBox { 
            padding-left: 12px;
            spacing: 4px;

            for member[index] in group_data.members: Rectangle {
                background: #303030;
                border-radius: 6px;
                height: 28px;
                
                HorizontalBox {
                    Rectangle {
                        width: 12px;
                        height: 12px;
                        background: member.methodology;
                        border-radius: 6px;
                    }
                    
                    Rectangle {
                        Text {
                            text: member.rank + " " + member.surname + " " + member.name;
                            color: #FFFFFF;
                            font-size: 14px;
                            vertical-alignment: center;
                        }
                    }
                }
            }
        }
    }
}

export component GroupsPanel inherits Rectangle {
    in property <[GroupData]> groups;
    background: #202020;
    height: 71%;
    width: 100%;

    ScrollView {
        width: 100%;
        height: 100%;

        VerticalBox {
            spacing: 8px;
            padding: 8px;

            for group[index] in groups: GroupItem { group_data: group; }
        }
    }
}
